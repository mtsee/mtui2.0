{"version":3,"sources":["../../dev/mtui/modal/Modal.jsx"],"names":["Modal","props","state","show","visible","div","document","createElement","setAttribute","mid","unmountComponentAtNode","Date","mark","setMid","dom","getElementById","body","appendChild","render","showOrHide","bind","callback","_this","showBefore","renderDiv","setState","showBack","closeBack","prevProps","onClick","btn","Component","type","children","other","handleClick","defaultProps","className","style","width","height"],"mappings":"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","file":"Modal.js","sourcesContent":["\r\nimport React, { Component } from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport ModalBox from './ModalBox';\r\nimport { removeDom } from '../utils/dom';\r\nimport { hideScroll, showScroll } from '../utils/bodyscroll';\r\n\r\nclass Modal extends Component {\r\n\r\n    // 默认参数\r\n    static defaultProps = {\r\n        className: '',\r\n        style: {width: 400, height: 260}, // 框样式\r\n        showBack: null, // 显示时候的回调\r\n        closeBack: null // 关闭时候的回调\r\n    }\r\n    \r\n    // 构造函数\r\n    constructor (props) {\r\n        super(props);\r\n        this.state = {\r\n            show: props.visible\r\n        };\r\n        this.div = document.createElement('div');\r\n        this.div.setAttribute('class', 'mt-div');\r\n        this.mid = null;\r\n    }\r\n\r\n    componentWillUnmount() {\r\n\r\n        removeDom(this.div);\r\n        ReactDOM.unmountComponentAtNode(this.div);\r\n    }\r\n\r\n    // \r\n    setMid(){\r\n        if(this.mid === null){\r\n            this.mid = 'mt_modal_' + +new Date();\r\n        }\r\n    }\r\n\r\n    // 渲染div\r\n    renderDiv(mark){\r\n        this.setMid();\r\n        var dom = document.getElementById(this.mid);\r\n        // 首次渲染即可\r\n        if(!dom || mark){\r\n            if(!dom){\r\n                document.body.appendChild(this.div);\r\n            }\r\n            ReactDOM.render(<ModalBox mid={this.mid} show={this.state.show} showOrHide={this.showOrHide.bind(this)} {...this.props}/>, this.div); // \r\n        }\r\n    }\r\n\r\n    // 隐藏显示\r\n    showOrHide(show, callback){\r\n\r\n        var _this = this;\r\n        if(!show && _this.props.showBefore){\r\n            _this.props.showBefore();\r\n        }\r\n        this.renderDiv();\r\n        this.setState({\r\n            show: !show\r\n        }, function(){\r\n\r\n            // 显示隐藏 scroll\r\n            if( !show ){\r\n                hideScroll();\r\n            }else {\r\n                showScroll();\r\n            }\r\n\r\n            // 显示隐藏 回调\r\n            if(!show && _this.props.showBack){\r\n                _this.props.showBack();\r\n            }else if( show && _this.props.closeBack){\r\n                _this.props.closeBack();\r\n            }\r\n\r\n            // 总回调\r\n            if(callback){\r\n                callback();\r\n            }\r\n        });\r\n    }\r\n\r\n    // 更新弹窗里面的数据, 如果DOM不存在，就不更新\r\n    componentDidUpdate(prevProps){\r\n        if(document.getElementById(this.mid)) {\r\n            this.renderDiv(true);\r\n        }\r\n    }\r\n\r\n    // 点击事件\r\n    handleClick(){\r\n        const _this = this;\r\n        this.showOrHide(this.state.show);\r\n        if(this.props.onClick){\r\n            this.props.onClick();\r\n        }\r\n    }\r\n\r\n    // 对外暴露的方法\r\n    showModal(mark){\r\n        this.showOrHide(!mark);\r\n    }\r\n\r\n    render(){\r\n\r\n        let dom = null;\r\n        if (this.props.btn) {\r\n            var Component = this.props.btn.type;\r\n            var {children, ...other} = this.props.btn.props;\r\n            dom = <Component onClick={this.handleClick.bind(this)} {...other}>{children}</Component>; // /\r\n        }\r\n        return dom;\r\n    }\r\n}\r\n\r\n// /主页\r\nexport default Modal;"]}